27/02/09 -MMM & Finamore
- Main changes from 2.0 to 2.1:
  * Libtstat: Changed the API for tstat_next_pckt()
  * added snap_len option in dump engine and fixed bug in skype runtime engine
  * added ip_complete option in dump engine to straightforward dump traces at level 3
  * added slice_win option in dump engine to control the slicing of the traffic in traces
  * added TODO
  * updated ChangeLog and NEWS.in
  * bugfix: corrected use of RUNTIME_CONFIG_IDLE and removed skype debug 
    message
  * bugfix in stderr/stdout redirection
  * bugfix: segmentation fault executing tstat without parameters
  * bugfix: segmentation fault using tstat.conf
  * tstat now execute even if no trace file is specified
  * changed format of print histograms using -H? option
  * New format for the file containing the internal networks
  * update tstat-conf subnet files to the new file format
  * SSL Handshake (Client/Server Hello) identification
  * Better IMAP4 matching
  * Adapted DirectConnect matching for partial packets
  * Added MySQL scripts
  * Obfuscated eMule/ED2K/KAD support
  * eMule 0.49b new opcodes added
  * Code for removal of duplicate TCP packets
  * Do not include duplicate datagrams in IP Histograms/RRDs
  * Minor IPv6 compatibility update
  * Bugfix: nocomplete flows were considered as UNKNOWN L7 flows in histograms
  * Change: in histograms, count unanswered UDP flows only in C2S direction, 
    not both
  * Use snprintf() to reduce problems with random stack overflows
  * Bug: wrong stop time in log.txt due to ctime() called twice in a row
  * Several MSN Chat bugfixes and paranoic string size checking
  * Added support for MPLS over ETH and MPLS over VLAN
  * Optional early closure for singleton TCP/UDP flows (SYN or UDP flooding)
  * SSH 2.0/1.99 Handshake identification
  * DNS identification
  * Change: ADX histogram includes only external addresses (if existing, i.e. -N defined)
  * ADX histogram: added 'adx_mask <size>' option to histogram configuration

19/10/08 -Finamore
-Restarting point for Tstat because a lot of changes/adds has been made

19/7/07 -RB
-Corrected a bug on the number of packets lost for RTP flows smaller then WINDOW_SIZE packets

7/7/06 -RB
-Added check for UDP packets duplicated (by Marco)

6/7/06 -RB
-Added decode for RTCP: reciever reports and sender reports.
-Added histograms:
	rtcp_cl_b - RTCP flow length [bytes]
	rtcp_mm_cl_b - associated MM flow length [bytes]
	rtcp_mm_cl_p - associated MM flow length [packets]
	rtcp_mm_bt - associated MM flow bitrate (sampled at each sender report)
	rtcp_bt	- RTCP flow bitrate [Kbit/s]
	rtcp_jitter - associated MM flow jitter (sampled at each reciever report)
	rtcp_rtt - associated MM flow RTT (sampled at each reciever report)
	rtcp_lost - associated MM flow lost packets per interval (sampled at each receiver report)
	rtcp_f_lost - associated MM flow fraction of lost packets per interval (sampled at each receiver report)
	rtcp_t_lost - associated MM flow total number of packets lost 
-New format for log_mm_complete
	COMMON METRICS
	-------------------------------------------------------------
	01 Type
	02 Protocol
	03 Source IP address
	04 Source port
	05 Destination IP address
	06 Destination port
	07 Packet number
	08 Average inter packet gap
	09 Average jitter
	10 Max jitter
	11 Min jitter
	12 Internal source
	13 Internal Destination
	14 Average TTL
	15 Max TTL
	16 Min TTL
	17 Flow start [s]
	18 Flow duration [s] 
	19 Data amount
	20 Average bitrate [b/s]
The following colons depend on the flow type:
	RTP METRICS
	-------------------------------------------------------------
	21 Ssrc (Source identifier)
	22 Lost packets
	23 Out of sequence packets
	24 Duplicated packets
	25 Late packets
	26 Payload type

	RTCP
	-------------------------------------------------------------
	21 Ssrc (source identifier)
	22 Lost packets
	23 Associated MM flow length [packets]
	24 Associated MM flow length [bytes]
	25 Average RTT
	26 Max RTT
	27 Min RTT
	28 RTT samples
	
	TCP
	-------------------------------------------------------------
	21 First HTTP packet
	22 First RTSP packet
	23 Out of sequence packets
	24 Duplicated packets
	25 Average RTT
	26 Max RTT
	27 Min RTT
	28 RTT samples
	29 RTT variance
	30 Average RTT
	31 Max RTT
	32 Min RTT
	33 RTT samples
	34 RTT variance
	35 First RTP packet
	36 First ICY packet

4/7/06 - RB
-Better identifican of RTCP flows using a check on SSRC
-Corrected a bug on the disabling of GLOBAL histo

29/6/06 - RB
-Added -g option for global histograms

9/6/06 - RB
-Changed ParseArg(): now it uses getopt_long() for parsing (tstat.c)
TODO: need to check the -dag option
-Changed strkmp() in strstr() (tcptype.c)

5/5/06 - RB - MGM
-Corrected bug that reallocate 'basename' on every call of create_new_outfiles()
-Corrected dump in bitrate if tstat is killed using <ctrl>+C or 
the trace is completed

4/5/06 - RB
-Corrected bug about the overflow of the bitrate. It use unsigned long long int 
to count bytes in delta T

3/5/06 - MGM RB
-Corrected bug about bitrate statistics caused by thread
-Corrected bug in proto_register(): the internal list was not created correctly
-Corrected bug about computing of ip_bitrate 

1/5/06 - MGM
-Corrected bugs for x86_64 architectures:
  MemCpy_OPTIMIZED
  cast (unsigned) in cast (unsigned long)
-Moved functions to manage timeval from tstat.c to output.c

28/4/06 - MGM DR
-Corrected definition of histograms accordinly with the RRDTOOL limit of 19 chars
-Added -L option to disable log engine
-Corrected a bug about -S option

19/4/06 - MGM
-Corrected bug that didn't allow to see statistics in live mode:
moved call to cleanup() outside if...

13/4/06 - MGM
-Corrected Makefile.in to add dependecies on new modules
-Added an embryo of Skype module (skype.c skype.h) with a 

23/3/06 - MGM
-Changed tcpdump.c to allow to capture even from unconfigured interfaces
(eliminated pcap_lookup_net() to have the mask that is never used...)


22/3/06 - MGM
-Added again the check on the maximum number of segments that a flow
trace to avoid problems with the collapsing systema that fails
when in a trace misses some segments (for example, drops from a probe).


8/3/06 - MGM
-Corrected a bug about "MAX_SEG_PERQUAD" that causes problems with 
the muscariello's euristic
-Corrected collapse_quad() to keep track of muscariello's euristic when the
first segment collapse
-Added euristic to control the effect to have 100% of duplicates in addsed()
-Eliminated flows not full-duplex from trace.c 
(if see SYN but not SYN+ACK and DATA the flow is assumed half duplex 
and immediately closed)


1.3.1   --      XXX
Features (Topix):
	* Added ttl measuremnts for udp connections.
	* Added average ttl measurements for both UDP and TCP.
	* Added average inter packet gap time for TCP.
	* Added jitter computation for TCP.
	* New log_rtp file format:
	Type
	Protocol
	Source IP address
	Source port
	Destination IP address
	Destination port
	Packet number
	Average inter packet gap
	Average Jitter
	Out of sequence
	Duplicate
	Internal source
	Internal destination
	TTL min
	TTL max
	TTL average
	Duration 
	Data amount
	Bitrate [b/s]
	SSRC (no TCP)
	Late (no TCP)
	Lost (no TCP)
	server_RTT avg (no UDP)
	server_RTT min (no UDP)
	server_RTT max (no UDP)
	server_RTT standard deviation (no UDP)
	server_RTT count (no UDP)
	client_RTT avg (no UDP)
	client_RTT min (no UDP)
	client_RTT max (no UDP)
	client_RTT standard deviation (no UDP)
	client_RTT count (no UDP)
	Relative time when HTTP flow recognized (no UDP)
	Relative time when RTSP flow recognized (no UDP)
	Relative time when RTP flow recognized (no UDP)
	Relative time when ICY flow recognized (no UDP)
	
Bugs:
	* Corrected a bug in the unique bytes computation
	

1.2.0	--	Fri Oct 21 18:02:30 CEST 2005


Features:
	* ERF format can now be processed in two different _files con file compressi()
	* added optimized MemCpy function 
	* added support for DPMI (dpmi.conf)
	* RRD: in the case where only rrd output is generated (pure_rrd_engine==TRUE) 
	  from a trace (live_flag==FALSE),  updates will be performed at a higher rate, 
	  i.e., every MIN_TIME_STEP (5sec) rather than MAX_TIME_STEP (5min)

Bugs:
	* fixating memory leak in rrd module
	* using optimal parameter in Makefile.in
	* used (udp|tcp)_flow_stat notation
	* #ifdef INTERNAL_WIRED -> if(internal_wired)
	* TCP flows closed by timeout will be recorded on the correct log_tcp_(no)complete
 	-----------------Topix-----------------------------------
	* Corrected a small bug that you couldn't compile correctly if RRD was missing

TODO:
	* complete, test and migrate to hyper_histo 
	* update HOWTO (correct ``val:'' keyword in rrd section) 
	* ctrunc++ (tcptrunc, udptrunc, opttrunc)

TOPIX:
	* Added FindConType which tries to guess if the tcp connection uses HTTP, RTSP and/or RTP
	* Added to the internal statistics a counter for tunneled RTP connections
	* Added a 97th coloun in the log files specifying the connection type see tcptype.h for details about the meaning
	* Modified: tcp_pair *tcp_flow_stat (struct ip *, struct tcphdr *ptcp, void *plast) -> tcp_pair *tcp_flow_stat (struct ip *, struct tcphdr *ptcp, void *plast,int *dir)
	  to be able to export the dir variable.
